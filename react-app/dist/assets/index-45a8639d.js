import{r as j,a as L,R as O}from"./vendor-57209f9c.js";import{P as C}from"./plotly-390a6e20.js";import{a as P}from"./utils-16f98fc8.js";import"ext/globalThis-this";import"css-globalThis-keywords";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const m of s.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&l(m)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();var k={exports:{}},A={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M=j,T=Symbol.for("react.element"),_=Symbol.for("react.fragment"),R=Object.prototype.hasOwnProperty,Y=M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V={key:!0,ref:!0,__self:!0,__source:!0};function E(d,a,n){var l,t={},s=null,m=null;n!==void 0&&(s=""+n),a.key!==void 0&&(s=""+a.key),a.ref!==void 0&&(m=a.ref);for(l in a)R.call(a,l)&&!V.hasOwnProperty(l)&&(t[l]=a[l]);if(d&&d.defaultProps)for(l in a=d.defaultProps,a)t[l]===void 0&&(t[l]=a[l]);return{$$typeof:T,type:d,key:s,ref:m,props:t,_owner:Y.current}}A.Fragment=_;A.jsx=E;A.jsxs=E;k.exports=A;var e=k.exports,$={},F=L;$.createRoot=F.createRoot,$.hydrateRoot=F.hydrateRoot;const U=({data:d,ticker:a,period:n})=>{const l=j.useMemo(()=>{var f,g,N,v;if(!(d!=null&&d.data)||d.data.length===0)return null;const m=d.data,{minSlope120:r,minSlope200:c}=d.analysis;let o=m;n!=="max"&&m.displayStartDate&&(o=m.filter(x=>new Date(x.date)>=m.displayStartDate),console.log(`ğŸ¯ Display data filtered: ${o.length} days for chart (${n} years)`));const p=o.map(x=>x.date),h=o.map(x=>x.close),i=o.map(x=>x.ma120||null),y=o.map(x=>x.ma200||null);console.log(`ğŸ“Š Chart data: ${p.length} points`),console.log(`ğŸ“ˆ Price range: $${Math.min(...h.filter(x=>x)).toFixed(2)} - $${Math.max(...h).toFixed(2)}`),console.log(`ğŸ”´ 120ì¼ ì´í‰ ìœ íš¨ í¬ì¸íŠ¸: ${i.filter(x=>x!==null).length}ê°œ`),console.log(`ğŸ”µ 200ì¼ ì´í‰ ìœ íš¨ í¬ì¸íŠ¸: ${y.filter(x=>x!==null).length}ê°œ`);const u=[{x:p,y:h,type:"scatter",mode:"lines",name:"Close Price",line:{color:"darkgray",width:1},hovertemplate:"<b>%{x}</b><br>Close: $%{y:.2f}<extra></extra>"},{x:p,y:i,type:"scatter",mode:"lines",name:"120-day MA",line:{color:"red",width:2},hovertemplate:"<b>%{x}</b><br>120-day MA: $%{y:.2f}<extra></extra>"},{x:p,y,type:"scatter",mode:"lines",name:"200-day MA",line:{color:"blue",width:2},hovertemplate:"<b>%{x}</b><br>200-day MA: $%{y:.2f}<extra></extra>"}];if(r&&r.ma120!==null){const x=new Date(r.date),S=new Date(p[0]),w=new Date(p[p.length-1]),b=x>=S&&x<=w;console.log(`ğŸ”´ 120ì¼ ì‹ í˜¸ ì§€ì : ${r.date}`),console.log(`ğŸ“Š ì°¨íŠ¸ ë²”ìœ„: ${p[0]} ~ ${p[p.length-1]}`),console.log(`âœ… ì‹ í˜¸ ì§€ì  ì°¨íŠ¸ ë‚´ í¬í•¨: ${b?"YES":"NO"}`),b?(console.log(`ğŸ”´ Adding 120ì¼ ë§ˆì»¤: ${r.date} at $${r.ma120.toFixed(2)} (ê¸°ìš¸ê¸°: ${(f=r.ma120Slope)==null?void 0:f.toFixed(6)})`),u.push({x:[r.date],y:[r.ma120],type:"scatter",mode:"markers+text",name:"Lowest Slope Point 120 MA",marker:{color:"red",size:12,symbol:"circle",line:{color:"white",width:2}},text:["Lowest Slope 120 MA"],textposition:"top center",textfont:{size:10,color:"red",family:"Arial"},hovertemplate:`<b>ğŸ”´ 120ì¼ ìµœì € ê¸°ìš¸ê¸° ì§€ì </b><br><b>ë‚ ì§œ:</b> %{x}<br><b>120ì¼ ì´í‰:</b> $%{y:.2f}<br><b>ê¸°ìš¸ê¸°:</b> ${(g=r.ma120Slope)==null?void 0:g.toFixed(6)}<extra></extra>`,showlegend:!0})):console.log("âš ï¸ 120ì¼ ì‹ í˜¸ ì§€ì ì´ ì°¨íŠ¸ ë²”ìœ„ ë°–ì— ìˆìŒ")}if(c&&c.ma200!==null){const x=new Date(c.date),S=new Date(p[0]),w=new Date(p[p.length-1]),b=x>=S&&x<=w;console.log(`ğŸ”µ 200ì¼ ì‹ í˜¸ ì§€ì : ${c.date}`),console.log(`ğŸ“Š ì°¨íŠ¸ ë²”ìœ„: ${p[0]} ~ ${p[p.length-1]}`),console.log(`âœ… ì‹ í˜¸ ì§€ì  ì°¨íŠ¸ ë‚´ í¬í•¨: ${b?"YES":"NO"}`),b?(console.log(`ğŸ”µ Adding 200ì¼ ë§ˆì»¤: ${c.date} at $${c.ma200.toFixed(2)} (ê¸°ìš¸ê¸°: ${(N=c.ma200Slope)==null?void 0:N.toFixed(6)})`),u.push({x:[c.date],y:[c.ma200],type:"scatter",mode:"markers+text",name:"Lowest Slope Point 200 MA",marker:{color:"blue",size:12,symbol:"star",line:{color:"white",width:2}},text:["Lowest Slope 200 MA"],textposition:"top center",textfont:{size:10,color:"blue",family:"Arial"},hovertemplate:`<b>ğŸ”µ 200ì¼ ìµœì € ê¸°ìš¸ê¸° ì§€ì </b><br><b>ë‚ ì§œ:</b> %{x}<br><b>200ì¼ ì´í‰:</b> $%{y:.2f}<br><b>ê¸°ìš¸ê¸°:</b> ${(v=c.ma200Slope)==null?void 0:v.toFixed(6)}<extra></extra>`,showlegend:!0})):console.log("âš ï¸ 200ì¼ ì‹ í˜¸ ì§€ì ì´ ì°¨íŠ¸ ë²”ìœ„ ë°–ì— ìˆìŒ")}return console.log(`ğŸ“Š Chart traces generated: ${u.length} traces`),console.log(`ğŸ“ˆ Data points: ${p.length}`),console.log(`ğŸ”´ 120ì¼ ì‹ í˜¸ í‘œì‹œ: ${r?"YES":"NO"}`),console.log(`ğŸ”µ 200ì¼ ì‹ í˜¸ í‘œì‹œ: ${c?"YES":"NO"}`),u},[d]),t={title:{text:`${a} Stock Price and Moving Averages (${n==="max"?"Max":n+" years"})`,font:{size:18,family:"Arial, sans-serif"}},xaxis:{title:"Date",type:"date",showgrid:!0,gridcolor:"#f0f0f0"},yaxis:{title:"Price ($)",showgrid:!0,gridcolor:"#f0f0f0"},hovermode:"x unified",showlegend:!0,legend:{x:0,y:1,bgcolor:"rgba(255,255,255,0.9)",bordercolor:"#ddd",borderwidth:1},plot_bgcolor:"#fafafa",paper_bgcolor:"white",margin:{t:80,r:30,b:60,l:80},height:600},s={responsive:!0,displayModeBar:!0,modeBarButtonsToRemove:["lasso2d","select2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines"],displaylogo:!1,toImageButtonOptions:{format:"png",filename:`${a}_moving_averages_${n}y`,height:600,width:1e3,scale:1}};return l?e.jsxs("div",{className:"chart-container",children:[e.jsxs("div",{className:"chart-header",children:[e.jsxs("h2",{children:["ğŸ“Š ",a," ì£¼ì‹ ì°¨íŠ¸"]}),e.jsxs("div",{className:"chart-info",children:[e.jsxs("span",{children:["ğŸ“ˆ ì´ ",d.data.length,"ì¼ ë°ì´í„°"]}),e.jsxs("span",{children:["ğŸ”´ 120ì¼ ì´í‰ ",d.analysis.ma120Days,"ê°œ"]}),e.jsxs("span",{children:["ğŸ”µ 200ì¼ ì´í‰ ",d.analysis.ma200Days,"ê°œ"]})]})]}),e.jsx(C,{data:l,layout:t,config:s,style:{width:"100%",height:"600px"},useResizeHandler:!0})]}):e.jsx("div",{className:"chart-container",children:e.jsx("div",{className:"chart-placeholder",children:e.jsx("p",{children:"ì°¨íŠ¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})})})},H=({onLoadData:d,loading:a,defaultTicker:n="QQQ"})=>{const[l,t]=j.useState(n),[s,m]=j.useState("3"),r=[{value:"3",label:"3 years"},{value:"6",label:"6 years"},{value:"9",label:"9 years"},{value:"12",label:"12 years"},{value:"max",label:"Max"}],c=i=>{i.preventDefault(),l.trim()&&!a&&d(l.trim().toUpperCase(),s)},o=i=>{t(i.target.value.toUpperCase())},p=i=>{t(i),a||d(i,s)},h=["MSFT","AAPL","NVDA","GOOGL","TSLA","AMZN","TSM","LLY","NOV","AVGO","ORCL","NFLX","META","QQQ","SPY"];return e.jsxs("div",{className:"controls-container",children:[e.jsxs("form",{onSubmit:c,className:"stock-controls",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"ticker",className:"control-label",children:"ì£¼ì‹ í‹°ì»¤:"}),e.jsxs("div",{className:"ticker-input-container",children:[e.jsx("input",{id:"ticker",type:"text",value:l,onChange:o,placeholder:"AAPL, MSFT, QQQ...",className:"ticker-input",disabled:a,maxLength:10}),e.jsxs("div",{className:"input-hint",children:["ì˜ˆì‹œ: ",h.slice(0,4).join(", ")]})]})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"period",className:"control-label",children:"ê¸°ê°„:"}),e.jsx("select",{id:"period",value:s,onChange:i=>m(i.target.value),className:"period-select",disabled:a,children:r.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]}),e.jsx("button",{type:"submit",className:`load-button ${a?"loading":""}`,disabled:a||!l.trim(),children:a?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Loading..."]}):"ğŸ“Š Load Data"})]}),e.jsxs("div",{className:"quick-select",children:[e.jsx("h3",{children:"ë¹ ë¥¸ ì„ íƒ:"}),e.jsx("div",{className:"quick-buttons",children:h.map(i=>e.jsx("button",{onClick:()=>p(i),className:`quick-button ${l===i?"active":""}`,disabled:a,title:`${i} ë°ì´í„° ë¡œë“œ`,children:i},i))})]})]})},Q=({data:d,ticker:a})=>{var o,p,h,i,y,u;const n=j.useMemo(()=>{if(!(d!=null&&d.data)||!d.analysis)return null;const{minSlope120:f,minSlope200:g}=d.analysis,N=d.data,v=N[N.length-1];return{minSlope120:f,minSlope200:g,latestData:v,totalDays:N.length,ma120Days:d.analysis.ma120Days,ma200Days:d.analysis.ma200Days}},[d]);if(!n)return e.jsx("div",{className:"analysis-placeholder",children:"ë¶„ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."});const{minSlope120:l,minSlope200:t,latestData:s}=n,m=f=>f?f>.5?{text:"ê°•í•œ ìƒìŠ¹",emoji:"ğŸš€",className:"strong-up"}:f>0?{text:"ìƒìŠ¹",emoji:"ğŸ“ˆ",className:"up"}:f<-.5?{text:"ê°•í•œ í•˜ë½",emoji:"ğŸ“‰",className:"strong-down"}:f<0?{text:"í•˜ë½",emoji:"ğŸ“‰",className:"down"}:{text:"ë³´í•©",emoji:"â¡ï¸",className:"neutral"}:{text:"N/A",emoji:"â“",className:"neutral"},r=m(s.ma120Slope),c=m(s.ma200Slope);return e.jsxs("div",{className:"analysis-container",children:[e.jsxs("div",{className:"analysis-header",children:[e.jsxs("h2",{children:["ğŸ“Š ",a," ì´ë™í‰ê· ì„  ë¶„ì„"]}),e.jsxs("div",{className:"analysis-summary",children:[e.jsxs("span",{children:["ì´ ",n.totalDays,"ì¼ ë°ì´í„°"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:["120ì¼ ì´í‰: ",n.ma120Days,"ê°œ"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:["200ì¼ ì´í‰: ",n.ma200Days,"ê°œ"]})]})]}),e.jsxs("div",{className:"analysis-grid",children:[l&&e.jsxs("div",{className:"analysis-card slope-analysis",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{children:"ğŸ”´ 120ì¼ ì´ë™í‰ê·  ìµœì € ê¸°ìš¸ê¸° ì§€ì "}),e.jsx("span",{className:"signal-marker",children:"â— ì›í˜• ë§ˆì»¤"})]}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ“… ë‚ ì§œ:"}),e.jsx("span",{className:"metric-value",children:l.date})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ’° 120ì¼ ì´í‰ê°€:"}),e.jsxs("span",{className:"metric-value",children:["$",(o=l.ma120)==null?void 0:o.toFixed(2)]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ“‰ ê¸°ìš¸ê¸°:"}),e.jsx("span",{className:"metric-value negative",children:(p=l.ma120Slope)==null?void 0:p.toFixed(6)})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ“Š ì°¨íŠ¸ í‘œì‹œ:"}),e.jsxs("span",{className:"signal-indicator",children:[e.jsx("span",{className:"signal-dot red"}),"ë¹¨ê°„ ì›í˜• ë§ˆì»¤ë¡œ í‘œì‹œë¨"]})]}),e.jsxs("p",{className:"analysis-note",children:[e.jsx("strong",{children:"ğŸ“ ì°¨íŠ¸ì—ì„œ ë¹¨ê°„ìƒ‰ ì›í˜•(â—) ë§ˆì»¤ë¥¼ í™•ì¸í•˜ì„¸ìš”!"}),e.jsx("br",{}),"ì´ ì§€ì ì€ 120ì¼ ì´ë™í‰ê· ì„ ì˜ ê¸°ìš¸ê¸°ê°€ ê°€ì¥ ê¸‰ê²©í•˜ê²Œ í•˜ë½í•œ ì‹œì ìœ¼ë¡œ, ì‹œì¥ ì¡°ì •ì´ë‚˜ í•˜ë½ íŠ¸ë Œë“œì˜ ê°€ì†í™”ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤."]})]})]}),t&&e.jsxs("div",{className:"analysis-card slope-analysis",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{children:"ğŸ”µ 200ì¼ ì´ë™í‰ê·  ìµœì € ê¸°ìš¸ê¸° ì§€ì "}),e.jsx("span",{className:"signal-marker",children:"â˜… ë³„ ë§ˆì»¤"})]}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ“… ë‚ ì§œ:"}),e.jsx("span",{className:"metric-value",children:t.date})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ’° 200ì¼ ì´í‰ê°€:"}),e.jsxs("span",{className:"metric-value",children:["$",(h=t.ma200)==null?void 0:h.toFixed(2)]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ“‰ ê¸°ìš¸ê¸°:"}),e.jsx("span",{className:"metric-value negative",children:(i=t.ma200Slope)==null?void 0:i.toFixed(6)})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"ğŸ“Š ì°¨íŠ¸ í‘œì‹œ:"}),e.jsxs("span",{className:"signal-indicator",children:[e.jsx("span",{className:"signal-dot blue",children:"â˜…"}),"íŒŒë€ ë³„í˜• ë§ˆì»¤ë¡œ í‘œì‹œë¨"]})]}),e.jsxs("p",{className:"analysis-note",children:[e.jsx("strong",{children:"ğŸ“ ì°¨íŠ¸ì—ì„œ íŒŒë€ìƒ‰ ë³„í˜•(â˜…) ë§ˆì»¤ë¥¼ í™•ì¸í•˜ì„¸ìš”!"}),e.jsx("br",{}),"ì´ ì§€ì ì€ 200ì¼ ì´ë™í‰ê· ì„ ì˜ ê¸°ìš¸ê¸°ê°€ ê°€ì¥ ê¸‰ê²©í•˜ê²Œ í•˜ë½í•œ ì‹œì ìœ¼ë¡œ, ì¥ê¸° íŠ¸ë Œë“œ ì „í™˜ì ì„ ë‚˜íƒ€ë‚¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤."]})]})]}),s.ma120&&s.ma200&&e.jsxs("div",{className:"analysis-card current-trend",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{children:"ğŸ“ˆ í˜„ì¬ íŠ¸ë Œë“œ ë¶„ì„"}),e.jsx("span",{className:"latest-date",children:s.date})]}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"trend-row",children:[e.jsx("span",{className:"trend-label",children:"120ì¼ ì´í‰ íŠ¸ë Œë“œ:"}),e.jsxs("span",{className:`trend-value ${r.className}`,children:[r.emoji," ",r.text,e.jsxs("small",{children:["(",s.ma120Slope>0?"+":"",(y=s.ma120Slope)==null?void 0:y.toFixed(4),")"]})]})]}),e.jsxs("div",{className:"trend-row",children:[e.jsx("span",{className:"trend-label",children:"200ì¼ ì´í‰ íŠ¸ë Œë“œ:"}),e.jsxs("span",{className:`trend-value ${c.className}`,children:[c.emoji," ",c.text,e.jsxs("small",{children:["(",s.ma200Slope>0?"+":"",(u=s.ma200Slope)==null?void 0:u.toFixed(4),")"]})]})]}),e.jsx("div",{className:"separator"}),e.jsxs("div",{className:"price-position",children:[e.jsx("h4",{children:"ğŸ’° í˜„ì¬ ì£¼ê°€ í¬ì§€ì…˜"}),e.jsxs("div",{className:"position-row",children:[e.jsx("span",{children:"í˜„ì¬ê°€:"}),e.jsxs("span",{className:"current-price",children:["$",s.close.toFixed(2)]})]}),e.jsxs("div",{className:"position-row",children:[e.jsx("span",{children:"120ì¼ ì´í‰ ëŒ€ë¹„:"}),e.jsxs("span",{className:s.close>s.ma120?"above":"below",children:[s.close>s.ma120?"âœ… ìƒíšŒ":"âŒ í•˜íšŒ",e.jsxs("small",{children:["(",((s.close/s.ma120-1)*100).toFixed(1),"%)"]})]})]}),e.jsxs("div",{className:"position-row",children:[e.jsx("span",{children:"200ì¼ ì´í‰ ëŒ€ë¹„:"}),e.jsxs("span",{className:s.close>s.ma200?"above":"below",children:[s.close>s.ma200?"âœ… ìƒíšŒ":"âŒ í•˜íšŒ",e.jsxs("small",{children:["(",((s.close/s.ma200-1)*100).toFixed(1),"%)"]})]})]})]})]})]}),e.jsxs("div",{className:"analysis-card technical-signals",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"ğŸ¯ ê¸°ìˆ ì  ì‹ í˜¸"})}),e.jsxs("div",{className:"card-content",children:[s.ma120&&s.ma200&&e.jsxs("div",{className:"signal-item",children:[e.jsx("span",{className:"signal-label",children:"ê³¨ë“  í¬ë¡œìŠ¤/ë°ë“œ í¬ë¡œìŠ¤:"}),e.jsx("span",{className:`signal-value ${s.ma120>s.ma200?"bullish":"bearish"}`,children:s.ma120>s.ma200?"ğŸŒŸ ê³¨ë“  í¬ë¡œìŠ¤ (ê°•ì„¸)":"ğŸ’€ ë°ë“œ í¬ë¡œìŠ¤ (ì•½ì„¸)"})]}),e.jsxs("div",{className:"signal-item",children:[e.jsx("span",{className:"signal-label",children:"120ì¼ ì´í‰ ëª¨ë©˜í…€:"}),e.jsxs("span",{className:`signal-value ${r.className}`,children:[r.emoji," ",r.text]})]}),e.jsxs("div",{className:"signal-item",children:[e.jsx("span",{className:"signal-label",children:"200ì¼ ì´í‰ ëª¨ë©˜í…€:"}),e.jsxs("span",{className:`signal-value ${c.className}`,children:[c.emoji," ",c.text]})]})]})]})]})]})},G=()=>e.jsxs("div",{className:"loading-spinner",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"ì£¼ì‹ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."}),e.jsx("small",{children:"ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”"})]}),z=({message:d})=>e.jsxs("div",{className:"error-message",children:[e.jsx("strong",{children:"âš ï¸ ì˜¤ë¥˜ ë°œìƒ:"})," ",d]}),I={ALPHA_VANTAGE:{baseURL:"https://www.alphavantage.co/query",key:"demo",function:"TIME_SERIES_DAILY"},FINNHUB:{baseURL:"https://finnhub.io/api/v1",key:"demo"},POLYGON:{baseURL:"https://api.polygon.io/v2",key:"demo"}};class B{constructor(){this.currentAPI="YAHOO_DIRECT",this.cache=new Map,this.rateLimitDelay=1e3}setAPIKey(a,n){I[a].key=n}async fetchStockData(a,n="3"){const l=`${a}_${n}`;if(this.cache.has(l))return console.log("ğŸ“¦ Using cached data for",l),this.cache.get(l);try{let t;switch(this.currentAPI){case"YAHOO_DIRECT":t=await this.fetchFromYahooDirect(a,n);break;case"ALPHA_VANTAGE":t=await this.fetchFromAlphaVantage(a,n);break;case"FINNHUB":t=await this.fetchFromFinnhub(a,n);break;default:throw new Error(`Unsupported API: ${this.currentAPI}`)}const s=this.processStockData(t,a,n);return this.cache.set(l,s),setTimeout(()=>this.cache.delete(l),10*60*1e3),s}catch(t){throw console.error("Error fetching stock data:",t),this.handleAPIError(t)}}async fetchFromYahooDirect(a,n){const l=new Date,t=new Date;if(n==="max")t.setFullYear(t.getFullYear()-20);else{const o=parseInt(n);t.setFullYear(t.getFullYear()-o-1)}const s=Math.floor(t.getTime()/1e3),m=Math.floor(l.getTime()/1e3),r=`https://query1.finance.yahoo.com/v7/finance/download/${a}?period1=${s}&period2=${m}&interval=1d&events=history&includeAdjustedClose=true`,c=`https://api.allorigins.win/raw?url=${encodeURIComponent(r)}`;console.log(`ğŸš€ Fetching from Yahoo Finance via CORS proxy for ${a} (period: ${n})`),console.log(`ğŸ“… Date range: ${t.toISOString().split("T")[0]} to ${l.toISOString().split("T")[0]}`),console.log(`ğŸ”— Using proxy: ${c}`);try{const o=await P.get(c,{timeout:3e4,responseType:"text",headers:{Accept:"text/csv"}});if(!o.data||o.data.includes("error")||!o.data.includes("Date"))throw new Error("Invalid CSV response from Yahoo Finance");return console.log(`ğŸ“Š Got ${o.data.split(`
`).length-1} lines from Yahoo Finance`),this.parseYahooCSV(o.data,n)}catch(o){return console.error("Yahoo Finance Direct API failed:",o),console.log("ğŸ”„ Fallback to Alpha Vantage..."),this.currentAPI="ALPHA_VANTAGE",await this.fetchFromAlphaVantage(a,n)}}parseYahooCSV(a,n){var m,r;const l=a.trim().split(`
`),t=l[0].split(",");console.log(`ğŸ“Š CSV Headers: ${t.join(", ")}`);const s=[];for(let c=1;c<l.length;c++){const o=l[c].split(",");o.length<6||o[4]==="null"||s.push({date:o[0],open:parseFloat(o[1]),high:parseFloat(o[2]),low:parseFloat(o[3]),close:parseFloat(o[4]),volume:parseInt(o[6]||o[5])})}if(s.sort((c,o)=>new Date(c.date)-new Date(o.date)),n!=="max"){const c=parseInt(n),o=new Date,p=new Date;p.setFullYear(p.getFullYear()-c),s.displayStartDate=p,s.displayEndDate=o,console.log(`ğŸ¯ Display period will be: ${p.toISOString().split("T")[0]} to ${o.toISOString().split("T")[0]}`)}return console.log(`ğŸ“ˆ Parsed ${s.length} days from Yahoo Finance CSV`),console.log(`ğŸ“… Full data range: ${(m=s[0])==null?void 0:m.date} to ${(r=s[s.length-1])==null?void 0:r.date}`),s}async fetchFromAlphaVantage(a,n){const{baseURL:l,key:t,function:s}=I.ALPHA_VANTAGE,m={function:s,symbol:a,outputsize:"full",apikey:t};console.log(`ğŸš€ Fetching FULL data from Alpha Vantage for ${a} (period: ${n})`),console.log("ğŸ“Š Using outputsize=full to ensure sufficient data for 200-day MA");const r=await P.get(l,{params:m,timeout:3e4});if(r.data["Error Message"])throw new Error(`Invalid symbol: ${a}`);if(r.data.Note)throw new Error("API rate limit exceeded. Please try again later.");const c=r.data["Time Series (Daily)"];if(!c)throw new Error("No data received from API");const o=this.convertAlphaVantageData(c,n);return console.log(`ğŸ“ˆ Fetched ${o.length} days of data`),o}convertAlphaVantageData(a,n){var t,s;const l=Object.entries(a).map(([m,r])=>({date:m,close:parseFloat(r["4. close"]),open:parseFloat(r["1. open"]),high:parseFloat(r["2. high"]),low:parseFloat(r["3. low"]),volume:parseInt(r["5. volume"])})).sort((m,r)=>new Date(m.date)-new Date(r.date));if(console.log(`ğŸ“… Full data range: ${(t=l[0])==null?void 0:t.date} to ${(s=l[l.length-1])==null?void 0:s.date}`),n!=="max"){const m=parseInt(n),r=new Date,c=new Date;c.setFullYear(c.getFullYear()-m);const o=new Date(c);o.setDate(o.getDate()-250),console.log(`ğŸ“Š Filtering data: ${o.toISOString().split("T")[0]} to ${r.toISOString().split("T")[0]}`),console.log(`ğŸ¯ Target period: ${c.toISOString().split("T")[0]} to ${r.toISOString().split("T")[0]} (${m} years)`);const p=l.filter(h=>{const i=new Date(h.date);return i>=o&&i<=r});return console.log(`ğŸ“ˆ Filtered to ${p.length} days (includes buffer for moving averages)`),p.displayStartDate=c,p.displayEndDate=r,p}return console.log(`ğŸ“ˆ Using all ${l.length} days (Max period)`),l}processStockData(a,n,l){var o,p;if(!a||a.length===0)throw new Error("No data available");console.log(`ğŸ“Š Processing ${a.length} days of data for ${n}`),console.log(`ğŸ“… Data date range: ${(o=a[0])==null?void 0:o.date} to ${(p=a[a.length-1])==null?void 0:p.date}`),a.length<200&&console.warn(`âš ï¸ Warning: Only ${a.length} days of data available. 200-day MA may be incomplete.`);const t=a.map((h,i)=>{const y={...h};if(i>=119){const u=a.slice(i-119,i+1).reduce((f,g)=>f+g.close,0);y.ma120=u/120}else y.ma120=null;if(i>=199){const u=a.slice(i-199,i+1).reduce((f,g)=>f+g.close,0);y.ma200=u/200}else y.ma200=null;return y});t.forEach((h,i)=>{i>0?(h.ma120!==null&&t[i-1].ma120!==null?h.ma120Slope=h.ma120-t[i-1].ma120:h.ma120Slope=null,h.ma200!==null&&t[i-1].ma200!==null?h.ma200Slope=h.ma200-t[i-1].ma200:h.ma200Slope=null):(h.ma120Slope=null,h.ma200Slope=null)});const s=t.filter(h=>h.ma120Slope!==null&&!isNaN(h.ma120Slope)),m=t.filter(h=>h.ma200Slope!==null&&!isNaN(h.ma200Slope));let r=null,c=null;return s.length>0&&(r=s.reduce((h,i)=>i.ma120Slope<h.ma120Slope?i:h),console.log(`ğŸ”´ 120ì¼ ìµœì € ê¸°ìš¸ê¸°: ${r.date} = ${r.ma120Slope.toFixed(6)}`)),m.length>0&&(c=m.reduce((h,i)=>i.ma200Slope<h.ma200Slope?i:h),console.log(`ğŸ”µ 200ì¼ ìµœì € ê¸°ìš¸ê¸°: ${c.date} = ${c.ma200Slope.toFixed(6)}`)),{ticker:n.toUpperCase(),period:l,data:t,analysis:{minSlope120:r,minSlope200:c,totalDays:t.length,ma120Days:s.length,ma200Days:m.length}}}handleAPIError(a){var n,l,t;return a.code==="ECONNABORTED"||a.message.includes("timeout")?new Error("Request timeout. Please try again."):((n=a.response)==null?void 0:n.status)===429?new Error("API rate limit exceeded. Please wait a moment and try again."):((l=a.response)==null?void 0:l.status)===401||((t=a.response)==null?void 0:t.status)===403?new Error("API key invalid or expired. Please check your API configuration."):a}async checkAPIStatus(){try{return await this.fetchStockData("AAPL","1"),{status:"ok",api:this.currentAPI}}catch(a){return{status:"error",error:a.message,api:this.currentAPI}}}}const D=new B,q=({onClose:d})=>{const[a,n]=j.useState(""),[l,t]=j.useState("ALPHA_VANTAGE"),s=()=>{a.trim()?(D.setAPIKey(l,a.trim()),alert("API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!"),d()):alert("API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")};return e.jsxs("div",{className:"api-settings",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"âš™ï¸ API ì„¤ì •"}),e.jsx("button",{onClick:d,className:"close-btn",children:"âœ•"})]}),e.jsxs("div",{className:"settings-content",children:[e.jsxs("div",{className:"setting-group",children:[e.jsx("label",{children:"API ì„ íƒ:"}),e.jsxs("select",{value:l,onChange:m=>t(m.target.value),children:[e.jsx("option",{value:"ALPHA_VANTAGE",children:"Alpha Vantage (ì¶”ì²œ)"}),e.jsx("option",{value:"FINNHUB",children:"Finnhub"})]})]}),e.jsxs("div",{className:"setting-group",children:[e.jsx("label",{children:"API í‚¤:"}),e.jsx("input",{type:"text",value:a,onChange:m=>n(m.target.value),placeholder:"API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"api-info",children:[l==="ALPHA_VANTAGE"&&e.jsxs("p",{children:["ë¬´ë£Œ í‚¤: ",e.jsx("a",{href:"https://www.alphavantage.co/support/#api-key",target:"_blank",rel:"noopener noreferrer",children:"alphavantage.co"})," (500 calls/day)"]}),l==="FINNHUB"&&e.jsxs("p",{children:["ë¬´ë£Œ í‚¤: ",e.jsx("a",{href:"https://finnhub.io",target:"_blank",rel:"noopener noreferrer",children:"finnhub.io"})," (60 calls/minute)"]})]}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{onClick:s,className:"save-btn",children:"ì €ì¥"}),e.jsx("button",{onClick:d,className:"cancel-btn",children:"ì·¨ì†Œ"})]})]}),e.jsx("style",{jsx:!0,children:`
        .api-settings {
          background: white;
          border-radius: 12px;
          padding: 1.5rem;
          margin-bottom: 1rem;
          box-shadow: 0 4px 20px rgba(0,0,0,0.15);
          border: 1px solid #e1e8ed;
        }
        
        .settings-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid #e9ecef;
        }
        
        .close-btn {
          background: none;
          border: none;
          font-size: 1.2rem;
          cursor: pointer;
          color: #666;
        }
        
        .setting-group {
          margin-bottom: 1rem;
        }
        
        .setting-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 600;
          color: #555;
        }
        
        .setting-group input,
        .setting-group select {
          width: 100%;
          padding: 0.75rem;
          border: 2px solid #e1e8ed;
          border-radius: 6px;
          font-size: 0.9rem;
        }
        
        .api-info {
          background: #f8f9fa;
          padding: 0.75rem;
          border-radius: 6px;
          margin-bottom: 1rem;
          font-size: 0.9rem;
        }
        
        .api-info a {
          color: #667eea;
          text-decoration: none;
        }
        
        .settings-actions {
          display: flex;
          gap: 0.5rem;
          justify-content: flex-end;
        }
        
        .save-btn, .cancel-btn {
          padding: 0.5rem 1rem;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 600;
        }
        
        .save-btn {
          background: #667eea;
          color: white;
        }
        
        .cancel-btn {
          background: #e9ecef;
          color: #555;
        }
      `})]})};function K(){const[d,a]=j.useState(null),[n,l]=j.useState(!1),[t,s]=j.useState(null),[m,r]=j.useState(""),[c,o]=j.useState(""),[p,h]=j.useState(!1);j.useEffect(()=>{i()},[]);const i=async()=>{try{const u=await D.checkAPIStatus();u.status==="error"&&console.warn("API Status:",u.error)}catch(u){console.warn("Failed to check API status:",u.message)}},y=j.useCallback(async(u,f)=>{if(!(u!=null&&u.trim())){s("ì£¼ì‹ í‹°ì»¤ ì‹¬ë³¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");return}l(!0),s(null);try{console.log(`ğŸ“ˆ Loading data for ${u.toUpperCase()}, period: ${f}`);const g=await D.fetchStockData(u,f);g&&g.data&&g.data.length>0?(a(g),r(u.toUpperCase()),o(f),console.log(`âœ… Successfully loaded ${g.data.length} days of data`),console.log(`ğŸ“Š 120-day MA points: ${g.analysis.ma120Days}`),console.log(`ğŸ“Š 200-day MA points: ${g.analysis.ma200Days}`)):(s("ì…ë ¥í•œ í‹°ì»¤ì— ëŒ€í•œ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),a(null))}catch(g){console.error("Error loading stock data:",g),s(g.message||"ì£¼ì‹ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."),a(null)}finally{l(!1)}},[]);return e.jsxs("div",{className:"app",children:[e.jsx("header",{className:"app-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"ğŸ“ˆ Stock Moving Averages Visualization"}),e.jsx("p",{children:"ì›ë³¸ yfiance-ma.pyì™€ ë™ì¼í•œ ë¶„ì„ ë¡œì§ | React + ë¬´ë£Œ API"}),e.jsx("button",{className:"api-settings-btn",onClick:()=>h(!p),children:"âš™ï¸ API ì„¤ì •"})]})}),e.jsxs("main",{className:"app-main",children:[p&&e.jsx(q,{onClose:()=>h(!1)}),e.jsx(H,{onLoadData:y,loading:n,defaultTicker:"QQQ"}),t&&e.jsx(z,{message:t}),n&&e.jsx(G,{}),d&&!n&&e.jsxs(e.Fragment,{children:[e.jsx(U,{data:d,ticker:m,period:c}),e.jsx(Q,{data:d,ticker:m})]}),!d&&!n&&!t&&e.jsx("div",{className:"welcome-message",children:e.jsxs("div",{className:"welcome-card",children:[e.jsx("h2",{children:"ğŸ“Š ì£¼ì‹ ì´ë™í‰ê· ì„  ë¶„ì„"}),e.jsx("p",{children:'ì£¼ì‹ í‹°ì»¤ë¥¼ ì…ë ¥í•˜ê³  "Load Data" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.'}),e.jsxs("div",{className:"suggested-tickers",children:[e.jsx("h3",{children:"ì¶”ì²œ í‹°ì»¤:"}),e.jsx("div",{className:"ticker-tags",children:["MSFT","AAPL","NVDA","GOOGL","TSLA","AMZN","QQQ","SPY"].map(u=>e.jsx("span",{className:"ticker-tag",children:u},u))})]}),e.jsxs("div",{className:"features",children:[e.jsx("h3",{children:"ì£¼ìš” ê¸°ëŠ¥:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"ğŸ“ˆ ì‹¤ì‹œê°„ ì£¼ì‹ ë°ì´í„° (ë¬´ë£Œ API)"}),e.jsx("li",{children:"ğŸ“Š 120ì¼ & 200ì¼ ì´ë™í‰ê· ì„ "}),e.jsx("li",{children:"ğŸ¯ ìµœì € ê¸°ìš¸ê¸° ì§€ì  ë¶„ì„"}),e.jsx("li",{children:"ğŸ“± ë°˜ì‘í˜• ë””ìì¸"})]})]})]})})]}),e.jsx("footer",{className:"app-footer",children:e.jsxs("p",{children:["Made with React + Vite |",e.jsx("a",{href:"https://github.com/yourusername/stock-app",target:"_blank",rel:"noopener noreferrer",children:"GitHub"})]})})]})}$.createRoot(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(K,{})}));
